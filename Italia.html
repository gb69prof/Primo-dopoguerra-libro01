<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Il primo dopoguerra in Italia</title>
  <style>
    :root{
      --paper:#fbf6ea;--ink:#1f1f1f;--muted:#6a6258;--accent:#7a2e2e;--line:rgba(140,120,90,.25);
      --shadow:0 18px 45px rgba(0,0,0,.18);
      --serif:ui-serif,"Iowan Old Style","Palatino Linotype",Palatino,Georgia,serif;
      --sans:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;
    }
    *{box-sizing:border-box}
    body{margin:0;background:#f1efe8;color:var(--ink);font-family:var(--sans)}
    .wrap{max-width:1000px;margin:28px auto;padding:0 14px 40px}
    .book{background:var(--paper);border:1px solid var(--line);border-radius:24px;box-shadow:var(--shadow);overflow:hidden}
    header{padding:22px 28px;border-bottom:1px solid var(--line)}
    h1{margin:0;font-family:var(--serif);font-size:30px}
    .page{padding:26px 30px}
    .page h2{font-family:var(--serif);margin-top:26px}
    .page p{font-family:var(--serif);font-size:17px;line-height:1.7;text-align:justify}

    .note-ref{
      cursor:pointer;
      border-bottom:2px solid rgba(122,46,46,.35);
      border-radius:6px;
      padding:0 2px;
      user-select:none;
      -webkit-tap-highlight-color: transparent;
    }
    .note-ref:hover{background:rgba(122,46,46,.08)}

    /* ===== Finestre mobili ===== */
    .win{
      position:fixed;
      left:100px; top:120px;
      width:520px; height:340px;
      min-width:280px; min-height:180px;
      max-width:92vw; max-height:80vh;
      background:#fffaf0;
      border:1px solid var(--line);
      border-radius:16px;
      box-shadow:var(--shadow);
      overflow:hidden;
      z-index:1200;
      touch-action:none; /* fondamentale su iPad */
    }
    .win-header{
      padding:10px 12px;
      background:rgba(122,46,46,.12);
      border-bottom:1px solid rgba(140,120,90,.18);
      cursor:grab;
      display:flex;
      justify-content:space-between;
      align-items:center;
      user-select:none;
    }
    .win-header:active{cursor:grabbing}
    .win-title{font-size:13px;text-transform:uppercase;letter-spacing:.2px}
    .win-btn{background:#fff;border:1px solid var(--line);border-radius:10px;cursor:pointer;padding:4px 10px;font-size:14px;line-height:1}
    .win-body{padding:12px 14px;overflow:auto;height:calc(100% - 46px);font-family:var(--serif);font-size:15px;line-height:1.55}
    .win-body h3{margin:0 0 10px;font-family:var(--sans);font-size:13px;text-transform:uppercase;letter-spacing:.25px}
    .win-body p{margin:0 0 10px}
    .win-body p:last-child{margin-bottom:0}
    .resize{
      position:absolute;
      right:8px; bottom:8px;
      width:16px; height:16px;
      border-radius:4px;
      background:rgba(140,120,90,.45);
      cursor:nwse-resize;
      touch-action:none;
    }
  </style>
</head>
<body>
<div class="wrap">
  <article class="book">
    <header><h1>Il primo dopoguerra in Italia</h1></header>
    <section class="page">

      <h2>Dal dopoguerra al Biennio rosso</h2>
      <p>L’Italia uscì dalla Prima guerra mondiale formalmente tra le potenze vincitrici, ma profondamente segnata dal conflitto. Il costo umano era stato altissimo, l’economia era in crisi e il debito pubblico era cresciuto in modo vertiginoso. La riconversione dall’economia di guerra a quella di pace provocò disoccupazione, inflazione e un generale peggioramento delle condizioni di vita. A questo si aggiunse la delusione per la cosiddetta “vittoria mutilata”, espressione con cui i nazionalisti indicarono il mancato ottenimento di tutti i territori promessi all’Italia al momento dell’entrata in guerra. Questo clima di frustrazione e instabilità favorì una crescente politicizzazione delle masse.</p>
      <p>Tra il 1919 e il 1920 il paese fu attraversato da un’ondata di proteste sociali nota come <span class="note-ref" data-pop="biennio">Biennio rosso</span>. Scioperi, manifestazioni e occupazioni di fabbriche e terre coinvolsero operai e contadini, che chiedevano salari più alti, migliori condizioni di lavoro e riforme sociali profonde. Sebbene queste mobilitazioni non si trasformassero in una vera rivoluzione, esse suscitarono un forte timore nei ceti medi e nelle classi dirigenti, che iniziarono a vedere nel movimento socialista una minaccia all’ordine sociale.</p>

      <h2>La nascita del fascismo</h2>
      <p>In questo contesto di crisi e paura, nel 1919 Benito Mussolini fondò i <span class="note-ref" data-pop="fasci">Fasci di Combattimento</span>. Il movimento si presentava come rivoluzionario e antiparlamentare, ma in realtà si pose fin da subito come forza antisocialista. A partire dal 1920 il fascismo si affermò soprattutto nelle campagne e nelle zone industriali del Nord grazie all’azione delle <span class="note-ref" data-pop="squadracce">squadracce</span>, gruppi armati che ricorrevano sistematicamente alla violenza contro sedi di partiti e sindacati di sinistra. Questa violenza fu spesso tollerata dalle autorità, che consideravano i fascisti un utile strumento per ristabilire l’ordine.</p>
      <p>Il consenso verso il fascismo crebbe rapidamente tra la borghesia, i proprietari terrieri e parte dei ceti medi, spaventati dal rischio di una rivoluzione socialista. In pochi anni il movimento si trasformò in un vero partito di massa, capace di presentarsi come l’unica forza in grado di garantire stabilità e sicurezza.</p>

      <h2>La Marcia su Roma e il governo Mussolini</h2>
      <p>Il momento decisivo dell’ascesa fascista fu la <span class="note-ref" data-pop="marcia">Marcia su Roma</span> del 28 ottobre 1922. Migliaia di squadristi si mobilitarono per intimidire lo Stato e dimostrare la forza del movimento. Il re Vittorio Emanuele III, temendo una guerra civile, rifiutò di proclamare lo stato d’assedio e affidò a Mussolini l’incarico di formare il governo. Sebbene formalmente avvenuto nel rispetto delle istituzioni, questo passaggio segnò una profonda rottura con il sistema liberale.</p>
      <p>Nei primi anni Mussolini governò attraverso una coalizione, ma lavorò progressivamente per concentrare il potere nelle proprie mani. Un passaggio fondamentale fu l’approvazione della <span class="note-ref" data-pop="acerbo">legge Acerbo</span> nel 1923, che modificò il sistema elettorale a vantaggio del partito di maggioranza.</p>

      <h2>Dalla crisi Matteotti alla dittatura</h2>
      <p>Le elezioni del 1924, svolte in un clima di intimidazione e violenza, garantirono ai fascisti una larga maggioranza. Il deputato socialista <span class="note-ref" data-pop="matteotti">Giacomo Matteotti</span> denunciò pubblicamente brogli e violenze, ma pochi giorni dopo venne rapito e assassinato. Il delitto provocò una grave crisi politica e morale, mettendo in luce il carattere violento del regime.</p>
      <p>Le opposizioni reagirono con la <span class="note-ref" data-pop="aventino">secessione dell’Aventino</span>, abbandonando il Parlamento in segno di protesta. Questa scelta si rivelò però inefficace: lasciò Mussolini senza una reale opposizione istituzionale. Il 3 gennaio 1925 Mussolini si assunse pubblicamente la responsabilità politica di quanto accaduto e avviò la trasformazione del governo in dittatura.</p>

      <h2>Il regime fascista</h2>
      <p>Tra il 1925 e il 1926 il fascismo instaurò uno <span class="note-ref" data-pop="totalitario">Stato totalitario</span>. Furono abolite le libertà politiche, sciolti i partiti, limitata la libertà di stampa e istituiti organi di repressione come il Tribunale speciale e la polizia politica. Il regime puntò a controllare non solo la vita politica, ma anche la società, l’educazione e la cultura, attraverso una capillare propaganda.</p>
      <p>Un momento importante nel consolidamento del regime fu la firma dei <span class="note-ref" data-pop="patti">Patti Lateranensi</span> nel 1929, che risolsero la questione romana e garantirono al fascismo il riconoscimento della Chiesa cattolica. Negli anni Trenta la politica estera aggressiva e l’alleanza con la Germania nazista portarono all’adozione delle <span class="note-ref" data-pop="razziali">leggi razziali</span> del 1938, che segnarono una grave violazione dei diritti civili e morali.</p>

    </section>
  </article>
</div>

<script>
  // Approfondimenti: testo esattamente come fornito dall'utente
  const NOTES = {
    biennio: {
      title: 'Biennio rosso (1919–1920)',
      html: `
        <h3>Biennio rosso (1919–1920)</h3>
        <p><b>Definizione</b><br>
        Con l’espressione <i>biennio rosso</i> si indica il periodo di forti tensioni sociali e politiche che attraversò l’Italia tra il 1919 e il 1920, caratterizzato da scioperi, occupazioni di fabbriche e mobilitazioni contadine.</p>
        <p><b>Significato storico</b><br>
        Il biennio rosso rivelò la fragilità dello Stato liberale e alimentò la paura di una rivoluzione sul modello bolscevico, favorendo la ricerca di soluzioni autoritarie da parte di ampi settori della società.</p>
      `
    },
    fasci: {
      title: 'Fasci di Combattimento',
      html: `
        <h3>Fasci di Combattimento</h3>
        <p><b>Definizione</b><br>
        I <i>Fasci di Combattimento</i> furono un movimento politico fondato da Benito Mussolini nel 1919, che riuniva ex combattenti, nazionalisti e gruppi ostili al socialismo.</p>
        <p><b>Significato storico</b><br>
        Il movimento si presentò inizialmente come forza antisistema, ma divenne rapidamente lo strumento attraverso cui il fascismo si organizzò e iniziò la conquista del potere.</p>
      `
    },
    squadracce: {
      title: 'Squadracce',
      html: `
        <h3>Squadracce</h3>
        <p><b>Definizione</b><br>
        Le <i>squadracce</i> erano gruppi armati di fascisti che ricorrevano sistematicamente alla violenza contro avversari politici, sindacalisti e sedi di partiti e giornali.</p>
        <p><b>Significato storico</b><br>
        La violenza squadrista minò le libertà democratiche e sostituì progressivamente il confronto politico con l’intimidazione, preparando il terreno alla dittatura.</p>
      `
    },
    marcia: {
      title: 'Marcia su Roma (1922)',
      html: `
        <h3>Marcia su Roma (1922)</h3>
        <p><b>Definizione</b><br>
        La <i>Marcia su Roma</i> fu una mobilitazione organizzata dai fascisti nell’ottobre 1922, culminata con l’incarico a Mussolini di formare il governo.</p>
        <p><b>Significato storico</b><br>
        Più che un colpo di Stato armato, fu una prova di forza politica che mostrò l’incapacità dello Stato liberale di difendersi e segnò l’inizio del potere fascista.</p>
      `
    },
    acerbo: {
      title: 'Legge Acerbo (1923)',
      html: `
        <h3>Legge Acerbo (1923)</h3>
        <p><b>Definizione</b><br>
        La <i>legge Acerbo</i> era una legge elettorale che assegnava i due terzi dei seggi alla lista che avesse ottenuto la maggioranza relativa dei voti.</p>
        <p><b>Significato storico</b><br>
        Essa alterò gravemente il principio di rappresentanza democratica e consentì al fascismo di consolidare il controllo del Parlamento.</p>
      `
    },
    matteotti: {
      title: 'Giacomo Matteotti',
      html: `
        <h3>Giacomo Matteotti</h3>
        <p><b>Definizione</b><br>
        Giacomo Matteotti fu un deputato socialista che denunciò pubblicamente le violenze e i brogli elettorali fascisti.</p>
        <p><b>Significato storico</b><br>
        Il suo rapimento e assassinio nel 1924 rappresentarono una svolta decisiva, rivelando la natura criminale del regime e accelerando la fine della democrazia parlamentare.</p>
      `
    },
    aventino: {
      title: 'Secessione dell’Aventino',
      html: `
        <h3>Secessione dell’Aventino</h3>
        <p><b>Definizione</b><br>
        La <i>secessione dell’Aventino</i> fu la scelta dei deputati antifascisti di abbandonare il Parlamento dopo l’uccisione di Matteotti.</p>
        <p><b>Significato storico</b><br>
        Questa decisione, pur motivata da intenti morali, si rivelò politicamente inefficace e lasciò campo libero a Mussolini.</p>
      `
    },
    totalitario: {
      title: 'Stato totalitario',
      html: `
        <h3>Stato totalitario</h3>
        <p><b>Definizione</b><br>
        Per <i>Stato totalitario</i> si intende un sistema politico in cui il potere controlla ogni aspetto della vita pubblica e privata, eliminando opposizione e pluralismo.</p>
        <p><b>Significato storico</b><br>
        Il fascismo italiano costruì progressivamente uno Stato totalitario attraverso la repressione, la propaganda e il controllo delle istituzioni.</p>
      `
    },
    patti: {
      title: 'Patti Lateranensi (1929)',
      html: `
        <h3>Patti Lateranensi (1929)</h3>
        <p><b>Definizione</b><br>
        I <i>Patti Lateranensi</i> furono gli accordi stipulati tra lo Stato italiano e la Santa Sede che risolsero la Questione romana.</p>
        <p><b>Significato storico</b><br>
        Essi rafforzarono il consenso al regime fascista, legittimandolo agli occhi di molti cattolici.</p>
      `
    },
    razziali: {
      title: 'Leggi razziali (1938)',
      html: `
        <h3>Leggi razziali (1938)</h3>
        <p><b>Definizione</b><br>
        Le <i>leggi razziali</i> furono provvedimenti che discriminavano ed escludevano gli ebrei dalla vita civile, scolastica e lavorativa.</p>
        <p><b>Significato storico</b><br>
        Segnarono il punto più alto della violenza ideologica del regime e dimostrarono il carattere profondamente antidemocratico e disumano dello Stato fascista.</p>
      `
    }
  };

  // ===== Finestre: apertura + drag + resize (Pointer Events: mouse + touch) =====
  let topZ = 1400;

  function clamp(n, min, max){ return Math.max(min, Math.min(max, n)); }

  function bringToFront(win){ win.style.zIndex = String(++topZ); }

  function openWindow(key, anchorRect){
    const note = NOTES[key];
    if(!note) return;

    // se già aperta, portala davanti
    const existing = document.querySelector(`.win[data-key="${key}"]`);
    if(existing){ bringToFront(existing); return; }

    const win = document.createElement('div');
    win.className = 'win';
    win.dataset.key = key;
    win.style.zIndex = String(++topZ);

    // posizione iniziale vicino alla parola cliccata
    const left0 = anchorRect ? anchorRect.left + 18 : 100;
    const top0  = anchorRect ? anchorRect.top + 24 : 120;
    win.style.left = clamp(left0, 8, window.innerWidth - 300) + 'px';
    win.style.top  = clamp(top0,  8, window.innerHeight - 220) + 'px';

    win.innerHTML = `
      <div class="win-header" data-drag>
        <div class="win-title">${note.title}</div>
        <button class="win-btn" data-close aria-label="Chiudi">×</button>
      </div>
      <div class="win-body">${note.html}</div>
      <div class="resize" data-resize title="Ridimensiona"></div>
    `;

    document.body.appendChild(win);

    // focus
    win.addEventListener('pointerdown', () => bringToFront(win));

    // close
    win.querySelector('[data-close]').addEventListener('click', (e) => {
      e.stopPropagation();
      win.remove();
    });

    // DRAG
    const dragHandle = win.querySelector('[data-drag]');
    dragHandle.addEventListener('pointerdown', (e) => {
      if(e.button !== undefined && e.button !== 0) return;
      e.preventDefault();
      bringToFront(win);

      const startX = e.clientX;
      const startY = e.clientY;
      const rect = win.getBoundingClientRect();
      const baseL = rect.left;
      const baseT = rect.top;

      dragHandle.setPointerCapture(e.pointerId);

      const onMove = (ev) => {
        const dx = ev.clientX - startX;
        const dy = ev.clientY - startY;
        const newL = clamp(baseL + dx, 8, window.innerWidth - rect.width - 8);
        const newT = clamp(baseT + dy, 8, window.innerHeight - rect.height - 8);
        win.style.left = newL + 'px';
        win.style.top  = newT + 'px';
      };

      const onUp = (ev) => {
        try{ dragHandle.releasePointerCapture(e.pointerId); }catch(_){ }
        dragHandle.removeEventListener('pointermove', onMove);
        dragHandle.removeEventListener('pointerup', onUp);
        dragHandle.removeEventListener('pointercancel', onUp);
      };

      dragHandle.addEventListener('pointermove', onMove);
      dragHandle.addEventListener('pointerup', onUp);
      dragHandle.addEventListener('pointercancel', onUp);
    });

    // RESIZE
    const resizeHandle = win.querySelector('[data-resize]');
    resizeHandle.addEventListener('pointerdown', (e) => {
      if(e.button !== undefined && e.button !== 0) return;
      e.preventDefault();
      bringToFront(win);

      const startX = e.clientX;
      const startY = e.clientY;
      const rect = win.getBoundingClientRect();
      const baseW = rect.width;
      const baseH = rect.height;

      resizeHandle.setPointerCapture(e.pointerId);

      const onMove = (ev) => {
        const dx = ev.clientX - startX;
        const dy = ev.clientY - startY;

        const maxW = Math.min(window.innerWidth - rect.left - 8, window.innerWidth * 0.92);
        const maxH = Math.min(window.innerHeight - rect.top - 8, window.innerHeight * 0.80);

        const w = clamp(baseW + dx, 280, Math.max(280, maxW));
        const h = clamp(baseH + dy, 180, Math.max(180, maxH));

        win.style.width = w + 'px';
        win.style.height = h + 'px';
      };

      const onUp = (ev) => {
        try{ resizeHandle.releasePointerCapture(e.pointerId); }catch(_){ }
        resizeHandle.removeEventListener('pointermove', onMove);
        resizeHandle.removeEventListener('pointerup', onUp);
        resizeHandle.removeEventListener('pointercancel', onUp);
      };

      resizeHandle.addEventListener('pointermove', onMove);
      resizeHandle.addEventListener('pointerup', onUp);
      resizeHandle.addEventListener('pointercancel', onUp);
    });
  }

  // attiva i link
  document.querySelectorAll('.note-ref').forEach(el => {
    el.addEventListener('click', () => {
      const key = el.getAttribute('data-pop');
      openWindow(key, el.getBoundingClientRect());
    });
  });

  // clamp soft al resize del viewport
  window.addEventListener('resize', () => {
    document.querySelectorAll('.win').forEach(w => {
      const r = w.getBoundingClientRect();
      const maxL = window.innerWidth - Math.min(r.width, window.innerWidth * 0.92) - 8;
      const maxT = window.innerHeight - Math.min(r.height, window.innerHeight * 0.80) - 8;
      w.style.left = clamp(r.left, 8, Math.max(8, maxL)) + 'px';
      w.style.top  = clamp(r.top,  8, Math.max(8, maxT)) + 'px';
    });
  }, {passive:true});
</script>
</body>
</html>
